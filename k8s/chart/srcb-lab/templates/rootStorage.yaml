apiVersion: v1
kind: PersistentVolume
metadata:
  name: {{ lower .Values.labName | splitList " " | join "-" }}-root
spec:
  capacity:
    storage: {{ .Values.storage }}
  accessModes:
    - ReadWriteMany
  flexVolume:
    driver: {{ .Values.flexVolume.driver }}
    options:
      monitors: {{ .Values.flexVolume.options.monitors }}
      share: '/'
      authid: {{ .Values.flexVolume.options.authid }}
      mds: {{ .Values.flexVolume.options.mds }}
      keyring: {{ .Values.flexVolume.options.keyring }}
  persistentVolumeReclaimPolicy: Retain
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: {{ lower .Values.labName | splitList " " | join "-" }}-root
spec:
  accessModes:
    - ReadWriteMany
  volumeName: {{ lower .Values.labName | splitList " " | join "-" }}-root
  resources:
    requests:
      storage: {{ .Values.storage }}
